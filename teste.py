# -*- coding: utf-8 -*-
from cryptography.hazmat.backends import default_backend
from cryptography.hazmat.primitives.asymmetric import rsa
import jwt
from jose.utils import base64_to_long


# Valores do JWK
modulus_base64url = "AKx5q-XQdJ3jSQ_2-ngY2VlE2TUdrhve2F-AT5GY6YUSNYEhw8ovLYFvjsKAbvx7zLXH-TyoRgY0gATRAJdbJIo2nafZeq-zolQ1ninJrw_FYMlUsZsXDsXk9XZgWhirbK9Ee4gSvTify2OQBZ4uPzdazUzvL1cPeo8Swi4nf2GBep5mInuCdttEWqMrRSHO2XZJwF6Ngp1Cn1OMVlfgzj0OrT2ml0NNwYrwFGnYdDpZ3auGyDkg6uJuvPVOIAzUHLRE632JS85uSR3BO_-LgQO-v3J_hy3YrtgJ53soTy5-4C0yif2sMFxWIWwET1yJgQEzedUf68MqxKzjvNwPRGKHKJvtx3vcTmwfuQZvfsC1TaOVsITG07P63vXhl-qjXmE01e7AnQuVQs4osSt9Cv9K_M3bxgLQsu2ZCuj3gFGzKPmjrAJZEktToR_jkUDjnP_n3SZ_sQo_4DwMBiEnFtwwUSvCxJRHnc29c5ROUL0kGGb8TPO_2V8qUc4E5voj6Q"
exponent_base64url = "AQAB"


# Decodifique o valor do módulo e do expoente a partir de Base64url
modulus_bytes = base64_to_long(modulus_base64url)
exponent_bytes = base64_to_long(exponent_base64url)

print(modulus_bytes)
print(exponent_bytes)
# Crie a chave pública RSA
public_numbers = rsa.RSAPublicNumbers(exponent_bytes,modulus_bytes)
backend = default_backend()
public_key = public_numbers.public_key(backend)

token = "eyJraWQiOiJYcEhKU0EiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIxOjYwOTgwODUyNjM3NjphbmRyb2lkOmM5YmQxZjQyYTBhZTIwZGZhYzk5MWQiLCJhdWQiOlsicHJvamVjdHNcLzYwOTgwODUyNjM3NiIsInByb2plY3RzXC9zaWdhbS10ZXN0LWFwcC0zNmI3ZSJdLCJwcm92aWRlciI6ImRlYnVnIiwiaXNzIjoiaHR0cHM6XC9cL2ZpcmViYXNlYXBwY2hlY2suZ29vZ2xlYXBpcy5jb21cLzYwOTgwODUyNjM3NiIsImV4cCI6MTcwNzE2ODg3MiwiaWF0IjoxNzA3MTY1MjcyLCJqdGkiOiJnLW9lV2pqR2E3STBZLUlEWjBFdU9SZ0dGV20tWmI1TmhjaG4yOUVBOGMwIn0.nxU9ZMYAarN1Mmuqmqn-AiifHqLzM_JqVoh4gnsv9etUMU2tgB3HQauxENBO1QJRpq5ONFi1PzAtQEsGPoKglQ-6JSrMAgkSXqaiVmmD3w220fvqp9C_e-7GV-k-VNbJdFjf8glLvesmPUm4woDc_99yRVGM7kVgqKs5C9VvyWoj92i64QvfS6X5tJvddEOcNiVFGOzW_EW-eGHD7YaEeJBTeI9GbAhahppc6_YejHQuTpnDM2fCWzC2Zx2_jAWn44vL4S_U1574C6_HhHp4sNddB7yF2SUfCm3OU5cX_fis-s81rODoHSO4P38tfej-4huLB-DUSXCIJ3xQC9WFmu3zrGT8gliG_9EitPf5adNQhiiWDPA5mmdgvix1EvevCOwJQ1jwXzxK3ADWEeOj39YMar_AHmKTDcNZYFzwz3fM84lTX-r8cvnKa2ihWz9qsZIByRI6fvQ9mn211QD3v6lXUuSKlnFq2Uh41KgTYrkO7uMtWYsOBOk3BsjV_Yp4"
decoded_token = jwt.decode(token, public_key, algorithms=["RS256"], audience="projects/sigam-test-app-36b7e", issuer="https://firebaseappcheck.googleapis.com/609808526376")
print(decoded_token)
